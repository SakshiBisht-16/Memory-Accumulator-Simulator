<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Memory Manager Dashboard</title>
<link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>

<body>
<div class="container">
    <h1>ðŸ§  Memory Manager Dashboard</h1>

    <!-- Allocate -->
    <div class="block">
        <h3>Allocate Memory</h3>
        <form method="POST">
            <input type="number" name="size" placeholder="Enter size (KB)" required>
            <button type="submit" name="allocate_submit">Allocate</button>
        </form>
    </div>

    <!-- Deallocate -->
    <div class="block">
        <h3>Deallocate Memory</h3>
        <form method="POST">
            <input type="number" name="pid" placeholder="Enter PID" required>
            <button type="submit" name="deallocate_submit">Deallocate</button>
        </form>
    </div>

    <!-- Compact -->
    <div class="block">
        <h3>Compact Memory</h3>
        <form method="POST">
            <button type="submit" name="compact_submit">Compact</button>
        </form>
    </div>

    <!-- Relation -->
    <div class="block">
        <h3>Add Process Relation</h3>
        <form method="POST">
            <input type="number" name="from_pid" placeholder="Parent PID" required>
            <input type="number" name="to_pid" placeholder="Child PID" required>
            <button type="submit" name="relation_submit">Add Relation</button>
        </form>
    </div>

    <!-- Show Graph -->
    <div class="block">
        <h3>Process Graph</h3>
        <form method="POST">
            <button type="submit" name="graph_submit">Show Graph</button>
        </form>
    </div>

    <!-- View Memory -->
    <div class="block">
        <h3>View Memory Map</h3>
        <form method="POST">
            <button type="submit" name="view_submit">View Memory</button>
        </form>
    </div>

    <!-- Logout -->
    <div class="block">
        <form method="POST">
            <button type="submit" name="logout_button">Logout</button>
        </form>
    </div>

    <div class="output">
        {% for key, value in outputs.items() %}
            <h3>{{ key|capitalize }} Output:</h3>
            <pre>{{ value }}</pre>
        {% endfor %}
    </div>
</div>

<script>
/* Send logout to server when the page is closed / refreshed / navigated away.
   sendBeacon is non-blocking and suitable for this purpose.
*/
window.addEventListener("beforeunload", function (event) {
    try {
        navigator.sendBeacon("/logout");
    } catch (e) {
        // fallback: synchronous XHR (not recommended), but we ignore errors
    }
});
</script>
</body>
</html>
